"use strict";(()=>{var e={};e.id=6267,e.ids=[6267],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{e.exports=require("assert")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},57147:e=>{e.exports=require("fs")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},41808:e=>{e.exports=require("net")},17718:e=>{e.exports=require("node:child_process")},22037:e=>{e.exports=require("os")},71017:e=>{e.exports=require("path")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},24404:e=>{e.exports=require("tls")},76224:e=>{e.exports=require("tty")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},81411:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>q,patchFetch:()=>P,requestAsyncStorage:()=>$,routeModule:()=>w,serverHooks:()=>k,staticGenerationAsyncStorage:()=>j});var o={};a.r(o),a.d(o,{HEAD:()=>b,POST:()=>x});var n=a(49303),s=a(88716),r=a(60670),i=a(92810),d=a(20021),c=a(56342),l=a(315),p=a(76129),u=a(51414),f=a(87320),m=a(94750),g=a(16292),h=a(1094);async function b(){return Response.json("",{status:d.Xd?.apiKey?200:401})}async function x(e){if(d.Xd?.config?.apiKey?.toLowerCase()!=="google ai studio")return Response.json("Oops! The selected model has a potential configuration conflict. Please ensure that all your open instances of VSCode have the same provider.",{status:400});let{messages:t}=await e.json();t=(0,l.D)({messages:t});let a=e.headers.get("model"),o=e.headers.get("filePath"),n=e.headers.get("promptType"),s=await m.Z.getLanguage(),r=await m.Z.getIdeLanguage(),c=e.headers.get("fileName")??"",u="Chat",h=t[t.length-1],b=h?.codeSelection??"";if(n){u=n+"CodeGPT";let e=(0,p.u)({promptType:n,cleanPromptText:h.content+b,language:r});e&&(t[t.length-1].content=e+h.content+b)}if(o){let e=JSON.stringify(await (0,i.LK)(o),null,2);t[t.length-1].content+=`${o}

    ${e}`}let x=a.includes("bison");x&&t.unshift({role:"system",content:"I am a helpful programming expert assistant. If you ask me a question that is rooted in truth, I will give you the answer in markdown. Follow the user's instructions with precision and attention to detail. Provide the code in a single block. Minimize any additional text."});let w=(0,f.q)(t.map(e=>e.content).join(""));t=(0,l.V)(t);try{let e=x?await y({fileName:c,messages:t,selectedCode:b,language:s,model:a,promptType:u,promptTokens:w,filePath:o}):await v({fileName:c,messages:t,selectedCode:b,language:s,model:a,promptType:u,promptTokens:w,filePath:o});return new g.wn(e)}catch(e){return Response.json({message:e.message,status:e.status??500},{status:e.status??500})}}let y=async({fileName:e,messages:t,selectedCode:a,language:o,model:n,promptType:s,promptTokens:r,filePath:i})=>{let l={prompt:{context:"I am a helpful programming expert assistant. If you ask me a question that is rooted in truth, I will give you the answer in markdown",examples:[{input:{content:"What is an API?"},output:{content:"An API is a set of rules for interacting with software or a service."}}],messages:t.map(e=>({content:e.content}))},candidate_count:1};if(!d.Xd.apiKey){let e=Error("You need to set your Google details first.");throw e.status=401,e}let p=await fetch(`https://generativelanguage.googleapis.com/v1beta3/models/${n??"gemini-pro"}:generateMessage?key=${d.Xd?.apiKey}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!p.ok){let e=await p.text();if(e.includes("API key not valid. Please pass a valid API key"))throw Error("Your API key is not valid. Please pass a valid API key");throw Error(e)}let m=await p.json(),g=async e=>{let t=(0,f.q)(e);(0,c.q)({eventName:s,provider:"googleAIStudio",model:n??"gemini-pro",promptTokens:r,completionTokens:t,totalTokens:r+t,statusCode:p.status})};if(i||a){let t=`<p style='display: flex; align-items: center; gap: 0.5rem;'>${s?`<span class='command command-bordered command-with-icon' data-command='command'><span class='max-w-48 overflow-hidden text-ellipsis whitespace-pre break-words pr-1 font-mono text-sm text-foreground'>${s}</span></span>`:""}${e?`<span class='command command-bordered command-with-icon animate-slideIn relative h-auto items-center gap-1 overflow-hidden' data-id=${o} data-language=${o}><span class='max-w-48 overflow-hidden text-ellipsis whitespace-pre break-words pr-1 font-mono text-sm text-foreground'>${e}</span></span>`:""}${i?`<span class='command command-bordered command-with-icon animate-slideIn relative h-auto items-center gap-1 overflow-hidden' data-language=${i.split("/").pop()?.split(".").pop()}><span class='max-w-48 overflow-hidden text-ellipsis whitespace-pre break-words pr-1 font-mono text-sm text-foreground'>${i.split("/").pop()}</span></span>`:""}</p>

 ${m?.candidates?.[0].content}`;return await (0,u.Yo)(t,{onFinal:g})}return await (0,u.Yo)(m?.candidates?.[0].content,{onFinal:g})},v=async({fileName:e,messages:t,selectedCode:a,language:o,model:n,promptType:s,promptTokens:r,filePath:i})=>{"user"!==t[0].role&&(t=t.slice(1));let l=d.Xd?.globalState?.config,p={contents:t.map(e=>({role:e.role.replace("system","model").replace("assistant","model").toUpperCase(),parts:{text:e.content}})),safety_settings:{category:"HARM_CATEGORY_HARASSMENT",threshold:"BLOCK_NONE"},generation_config:{temperature:l?.temperature??.3,candidateCount:1}};if(!d.Xd.apiKey){let e=Error("You need to set your Google details first.");throw e.status=401,e}let m=`https://generativelanguage.googleapis.com/v1beta/models/${n}:streamGenerateContent?key=${d.Xd?.apiKey}`,g=await fetch(m,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(!g.ok){let e=await g.text();if(e.includes("API key not valid. Please pass a valid API key"))throw Error("Your API key is not valid. Please pass a valid API key");throw Error(e)}let b=await (0,h.O)(g,{onFinal:async e=>{let t=(0,f.q)(e);(0,c.q)({eventName:s,provider:"googleAIStudio",model:n,promptTokens:r,completionTokens:t,totalTokens:r+t,statusCode:g.status})}}),x=t.slice(0,-1).some(e=>e.content.includes(a));return i||a&&(s||!x)?await (0,u.VU)([`<p style='display: flex; align-items: center; gap: 0.5rem;'>${s?`<span class='command command-bordered command-with-icon' data-command='command'><span class='max-w-48 overflow-hidden text-ellipsis whitespace-pre break-words pr-1 font-mono text-sm text-foreground'>${s}</span></span>`:""}${e?`<span class='command command-bordered command-with-icon animate-slideIn relative h-auto items-center gap-1 overflow-hidden' data-id=${o} data-language=${o}><span class='max-w-48 overflow-hidden text-ellipsis whitespace-pre break-words pr-1 font-mono text-sm text-foreground'>${e}</span></span>`:""}${i?`<span class='command command-bordered command-with-icon animate-slideIn relative h-auto items-center gap-1 overflow-hidden' data-language=${i.split("/").pop()?.split(".").pop()}><span class='max-w-48 overflow-hidden text-ellipsis whitespace-pre break-words pr-1 font-mono text-sm text-foreground'>${i.split("/").pop()}</span></span>`:""}</p>

`],b):b},w=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/[port]/api/(providers)/(google)/googleaistudio/route",pathname:"/[port]/api/googleaistudio",filename:"route",bundlePath:"app/[port]/api/(providers)/(google)/googleaistudio/route"},resolvedPagePath:"/Users/maol/WebstormProjects/Trabajo/codegpt-nextjs/app/[port]/api/(providers)/(google)/googleaistudio/route.ts",nextConfigOutput:"standalone",userland:o}),{requestAsyncStorage:$,staticGenerationAsyncStorage:j,serverHooks:k}=w,q="/[port]/api/(providers)/(google)/googleaistudio/route";function P(){return(0,r.patchFetch)({serverHooks:k,staticGenerationAsyncStorage:j})}},92810:(e,t,a)=>{a.d(t,{LK:()=>R});var o=a(24330);a(60166);var n=a(20021),s=a(94750),r=a(80050),i=a(8811),d=a(17718),c=a(40618);let l=async e=>{r.Z.post(`${(0,n.vx)()}/copy`,{code:e})},p=async()=>r.Z.get(`${(0,n.vx)()}/paste`).then(e=>e.data),u=async e=>{r.Z.post(`${(0,n.vx)()}/openUrl`,{url:e})},f=async e=>r.Z.post(`${(0,n.vx)()}/openWebviewUrl`,{url:e}).then(e=>e.data),m=async e=>r.Z.post(`${(0,n.vx)()}/insertCode`,{code:e}).then(e=>e.data),g=async(e,t)=>r.Z.post(`${(0,n.vx)()}/config`,{key:e,value:t}).then(e=>e.data),h=async e=>r.Z.post(`${(0,n.vx)()}/orgId`,{value:e}).then(e=>e.data),b=async e=>r.Z.post(`${(0,n.vx)()}/apiKey`,{value:e}).then(e=>e.data),x=async e=>r.Z.post(`${(0,n.vx)()}/customLink`,{value:e}).then(e=>e.data),y=async e=>r.Z.post(`${(0,n.vx)()}/googleOauth`,{value:e}).then(e=>e.data),v=async e=>r.Z.post(`${(0,n.vx)()}/setMaxTokens`,{value:Number(e)}).then(e=>e.data),w=async e=>r.Z.post(`${(0,n.vx)()}/setTemperature`,{value:Number(e)}).then(e=>e.data),$=async e=>r.Z.post(`${(0,n.vx)()}/setWindowMemory`,{value:Number(e)}).then(e=>e.data),j=async e=>r.Z.post(`${(0,n.vx)()}/setRegion`,{value:e}).then(e=>e.data),k=async e=>r.Z.post(`${(0,n.vx)()}/setAccessKeyId`,{value:e}).then(e=>e.data),q=async e=>r.Z.post(`${(0,n.vx)()}/setSecretAccessKey`,{value:e}).then(e=>e.data),P=async e=>r.Z.post(`${(0,n.vx)()}/setSessionToken`,{value:e}).then(e=>e.data),Z=async e=>r.Z.post(`${(0,n.vx)()}/changeIframeUrl`,{url:e}).then(e=>e.data),A=async e=>r.Z.post(`${(0,n.vx)()}/autocompleteEnabled`,{value:e}).then(e=>e.data),I=async e=>r.Z.post(`${(0,n.vx)()}/autocompleteMaxTokens`,{value:Number(e)}).then(e=>e.data),T=async e=>r.Z.post(`${(0,n.vx)()}/autocompleteModel`,{value:e}).then(e=>e.data),S=async e=>r.Z.post(`${(0,n.vx)()}/autocompleteDelay`,{value:Number(e)}).then(e=>e.data),C=async()=>({selectedCode:await r.Z.get(`${(0,n.vx)()}/getSelectedText/full`).then(e=>e.data)}),N=async()=>await s.Z.getFileName(),E=async()=>new Promise((e,t)=>{(0,d.exec)("ollama ls",t=>{e(!t)})}),O=async()=>await r.Z.get(`${(0,n.vx)()}/getProjectStructure`).then(e=>e.data),R=async e=>(console.log(`${(0,n.vx)()}/getFileContent?filePath=${e}`),await r.Z.get(`${(0,n.vx)()}/getFileContent?filePath=${e}`).then(e=>e.data)),K=async()=>{try{let e=await r.Z.get(`http://localhost:54112/${(0,n.vx)().split("http://localhost:")[1]}/api/settings/paths-from-project`);if(!1===e.data.ok)return console.error("No project is currently open.",e.data.error),null;if(!e.data)return console.error("Response data is undefined or null."),null;return e.data}catch(e){throw console.error("Error in getAllPathsFromProject:",e),e}},M=async e=>{let t=await K()||[];return t.length?new i.Z(t).search(e,{limit:6}):[]},F=async()=>{let e=await K()||[];if(!e.length)return[];let t=new Set;for(let a of e){let e=a?.split("/"),o=e?.length>1?e?.pop():a,n=o?.split("."),s=n?.length>1&&n?.pop();s&&t.add(s)}return Array.from(t)},L=async()=>await r.Z.get(`${(0,n.vx)()}/extensionVersion`).then(e=>!1===e.data.ok?(console.error("Error in getExtensionVersion:",e.data.error),null):e.data);(0,c.h)([l,p,u,f,m,g,h,b,x,y,v,w,$,j,k,q,Z,A,I,T,S,C,N,E,O,R,M,K,F,L,P]),(0,o.j)("43d9f8a113de9532d7f1b5158d76df8e6035ae62",l),(0,o.j)("494595f21851e24e2675ab82701473fa766407f6",p),(0,o.j)("065c306c307ba23aaa4f6db681692c28fff69acf",u),(0,o.j)("be0b1e94bccc9bf2f97cfb03dfe2ad2d45b1e08e",f),(0,o.j)("b8b2a06cfc6e2f2bff70a2218f5e6edf51572342",m),(0,o.j)("639ac588af3993db313cc50b124f78d7bdeae5c6",g),(0,o.j)("4f66078350237ca2fbccb2468f686b73ba7d48e5",h),(0,o.j)("c1cbe8fb18030fe2fb0552612558dd591d7e3a6a",b),(0,o.j)("23110510af7e4521b751ca814f230351d92fbfc8",x),(0,o.j)("985414b4c43eb752fd95156f1e0e25b48329a11b",y),(0,o.j)("b57504e3c6736fe21ad47feee5118810127fc521",v),(0,o.j)("01a77ea1f2d7ac26aa9c3809fa6058c5554510b0",w),(0,o.j)("ebd5f93df29041c36fc7878ac6bd2287b8e80b55",$),(0,o.j)("8cec80b1460388afc7c62c6c4a80d044e56b789b",j),(0,o.j)("a6f38e794db85a0cfe61a9946ba0bfad1f977da1",k),(0,o.j)("3aa157e078d770c04724433f8fcffb048e5840ea",q),(0,o.j)("46307867519e39b0d1f2824f6979ac7dcd69d28a",Z),(0,o.j)("79171721318480b6ddfef331134843c78c0e03ef",A),(0,o.j)("eb3c8476530358bec1b2bd936ba6142f81689a23",I),(0,o.j)("e071b912015fb6bac20bb8bd85aa14c8b77d5a57",T),(0,o.j)("816d0b833d5a41aa27415e5466c48710a0cd6eab",S),(0,o.j)("bdf0c56a5e7ff99fb7034af78b7573252d609a78",C),(0,o.j)("9ef61f493ad7e742ef4b625e835df92eb1757794",N),(0,o.j)("e93dc668f76aa03b424a7331e85ea18f21bdda31",E),(0,o.j)("8a47bc18e9d03b84169eb3752379a5f28a84327e",O),(0,o.j)("d10992d2f26bdaf3e1200801a9a2288f2bef2855",R),(0,o.j)("2b2edcffca34048d07293a8d9cc28477aa9164d6",M),(0,o.j)("4219fbe6f6fbb131c58a527305f7d1edcee275a8",K),(0,o.j)("c9e6df4eb710b551fc8e6b489a51061df934531d",F),(0,o.j)("0ca3b749e1b88374a50d08881f6f99cee2242df1",L),(0,o.j)("c3c88ce47acb86a5a282c00537f75035759d5b86",P)},1094:(e,t,a)=>{a.d(t,{O:()=>o});async function o(e,t){let a=e.body?.getReader();if(!a)throw Error("No reader available");return new ReadableStream({async start(e){let o=new TextDecoder("utf-8"),n="";t?.onStart?.();let s="";for(;;){let{done:i,value:d}=await a.read();if(i){r(),t?.onFinal?.(n),t?.onCompletion?.(n),e.close();return}let c=o.decode(d);s+=c,r()}function r(){let a;let o=/"text":\s*"((\\"|[^"])*)"/g;for(;null!==(a=o.exec(s));){let o=function(e){try{return JSON.parse(`"${e}"`)}catch(t){return console.error("Error unescaping string",e),e}}(a[1]);e.enqueue(o),t?.onToken?.(o),n+=o,s=s.slice(a.index+a[0].length)}}},cancel(){a.releaseLock()}})}},87320:(e,t,a)=>{a.d(t,{q:()=>n});var o=a(72223);let n=(e,t)=>(0,o.b9)(t??"gpt-4").encode(e).length??0}};var t=require("../../../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),o=t.X(0,[8948,1203,50,4104,6292,7179,8811,2223,6342,8910],()=>a(81411));module.exports=o})();