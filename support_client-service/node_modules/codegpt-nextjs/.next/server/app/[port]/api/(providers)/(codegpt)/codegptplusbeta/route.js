"use strict";(()=>{var e={};e.id=5362,e.ids=[5362],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{e.exports=require("assert")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},57147:e=>{e.exports=require("fs")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},41808:e=>{e.exports=require("net")},17718:e=>{e.exports=require("node:child_process")},22037:e=>{e.exports=require("os")},71017:e=>{e.exports=require("path")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},24404:e=>{e.exports=require("tls")},76224:e=>{e.exports=require("tty")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},31944:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>q,patchFetch:()=>P,requestAsyncStorage:()=>j,routeModule:()=>w,serverHooks:()=>Z,staticGenerationAsyncStorage:()=>$});var o={};a.r(o),a.d(o,{GET:()=>y,HEAD:()=>x,POST:()=>v});var s=a(49303),r=a(88716),n=a(60670),c=a(92810),d=a(20021),i=a(56342),p=a(95151),l=a(315),u=a(76129),f=a(51414),g=a(94750),h=a(16292),b=a(74506);let m="https://api.codegpt.co/api/v1";async function x(){let e=await (0,b.Z)();return Response.json("",{status:e||d.Xd.apiKey?200:401})}async function y(){if(d.Xd?.config?.apiKey?.toLowerCase()!=="codegpt plus beta")return Response.json("Oops! The selected model has a potential configuration conflict. Please ensure that all your open instances of VSCode have the same provider.",{status:400});try{let e=d.Xd.secrets?.["CodeGPT Plus Beta_orgId"],t=await (0,b.Z)();if(!(t||d.Xd.apiKey))return Response.json({agents:[],marketplace:[]});let a={Authorization:`Bearer ${t||d.Xd.apiKey||""}`,"Content-Type":"application/json",...e?{"CodeGPT-Org-Id":e}:{},"Access-Control-Allow-Origin":"*"},o=await Promise.all([fetch(`${m}/agents`,{headers:a}).then(e=>e.json()),fetch(`${m}/agents/marketplace-favorites`,{headers:a}).then(e=>e.json())]);return Response.json({agents:Array.isArray(o[0])?o[0]:[],marketplace:Array.isArray(o[1])?o[1]:[]})}catch(e){return console.log(e),Response.json(e.message,{status:e.status??500})}}async function v(e){var t;if(d.Xd?.config?.apiKey?.toLowerCase()!=="codegpt plus beta")return Response.json("Oops! The selected model has a potential configuration conflict. Please ensure that all your open instances of VSCode have the same provider.",{status:400});let a="true"===e.headers.get("fromMarketplace");console.log("Agent from Marketplace",a);let{messages:o}=await e.json(),s=(o=(0,l.D)({messages:o,fromMarketplace:a}))[o.length-1],{image:r}=s,n=r?"gpt-4o":e.headers.get("model"),x=e.headers.get("filePath"),y=e.headers.get("promptType"),v="53f3c928-9d9f-4aae-a3e1-058d657f286a"===n||"stackOverflow"===y,w=await g.Z.getLanguage(),j=await g.Z.getIdeLanguage(),$=e.headers.get("fileName")??"",Z="Chat",q=s?.codeSelection??"";if(y&&!v){Z=y+"CodeGPT";let e=(0,u.u)({promptType:y,cleanPromptText:s.content+q,language:j});e&&(o[o.length-1].content=e+s.content+q)}if(x){let e=JSON.stringify(await (0,c.LK)(x),null,2);o[o.length-1].content+=`${x}

    ${e}`}let P=(t=(t=n??"").toLowerCase(),!/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/.test(t));P&&r&&(o=[{role:"system",content:[{type:"text",text:"You have provided an image. I will describe it unless you provide a specific instruction."}]},{role:"user",content:[{type:"image_url",image_url:{url:r,detail:"high"}},...s.content?[{type:"text",text:s.content}]:[]]}]),v&&o.push({role:"system",content:`- You have been asked to search Stack Overflow for the given query.
- Use the searchStackOverflow function to search Stack Overflow and retrieve the most relevant results to respond to the user's query and give to user a complete response.`});try{let e=d.Xd.secrets?.["CodeGPT Plus Beta_orgId"],t=await (0,b.Z)(),r=!!(t||d.Xd?.apiKey),c=s.statusId,u=d.Xd?.globalState?.config;o=(0,l.V)(o);let j={...P?{model:n?.toLowerCase()}:{agentId:n},messages:o,temperature:u?.temperature??0,statusId:c},C=r?P?`${m}/chat/completion`:a?`${m}/chat/marketplace/agents`:`${m}/chat/extension`:`${m}/chat/limited`;console.log(o),console.log({isStackOverflow:v});let k=async(a,o=!0,s=!0)=>await fetch(C,{method:"POST",headers:{Authorization:`Bearer ${t||d.Xd.apiKey||""}`,"Content-Type":"application/json",tokens:"true",source:"api",channel:process.env.SOURCE||"vscode","codegpt-version":await g.Z.getVersion(),"distinct-id":await g.Z.getUserId(),...e?{"CodeGPT-Org-Id":e}:{}},body:JSON.stringify({...j,...v?{functions:(0,p.g)(["searchStackOverflow"])}:{},...v?{function_call:{name:"searchStackOverflow"}}:{},messages:a,stream:o,...s?{format:"json"}:{}})}),T=await k(o);if((0,i.q)({eventName:Z,provider:"CodeGPT Plus Beta",model:P?n??"gpt-3.5-turbo":"agentId: "+n,statusCode:T.status}),429===T.status)return Response.json({message:"You have reached your daily request limit. Connecto to CodeGPT Plus to increase your free daily limit or upgrade your plan for unlimited interactions."},{status:429});let S=o.slice(0,-1).some(e=>e.content.includes(q));if(x||q&&(y||!S)){let e=await (0,f.VU)([`<p style='display: flex; align-items: center; gap: 0.5rem;'>${y?`<span class='command command-bordered command-with-icon' data-command='command'><span class='max-w-48 overflow-hidden text-ellipsis whitespace-pre break-words pr-1 font-mono text-sm text-foreground'>${y}</span></span>`:""}${$?`<span class='command command-bordered command-with-icon animate-slideIn relative h-auto items-center gap-1 overflow-hidden' data-id=${w} data-language=${w}><span class='max-w-48 overflow-hidden text-ellipsis whitespace-pre break-words pr-1 font-mono text-sm text-foreground'>${$}</span></span>`:""}${x?`<span class='command command-bordered command-with-icon animate-slideIn relative h-auto items-center gap-1 overflow-hidden' data-language=${x.split("/").pop()?.split(".").pop()}><span class='max-w-48 overflow-hidden text-ellipsis whitespace-pre break-words pr-1 font-mono text-sm text-foreground'>${x.split("/").pop()}</span></span>`:""}</p>

`],T.body),t=(0,f.q_)(e,k,o);return new h.wn(t)}let O=(0,f.q_)(T.body,k,o);return new h.wn(O)}catch(e){return(0,i.q)({eventName:Z,provider:"CodeGPT Plus Beta",model:P?n??"gpt-3.5-turbo":"agentId: "+n,statusCode:e.status??500}),Response.json({message:e.message,status:e.status??500},{status:e.status??500})}}let w=new s.AppRouteRouteModule({definition:{kind:r.x.APP_ROUTE,page:"/[port]/api/(providers)/(codegpt)/codegptplusbeta/route",pathname:"/[port]/api/codegptplusbeta",filename:"route",bundlePath:"app/[port]/api/(providers)/(codegpt)/codegptplusbeta/route"},resolvedPagePath:"/Users/maol/WebstormProjects/Trabajo/codegpt-nextjs/app/[port]/api/(providers)/(codegpt)/codegptplusbeta/route.ts",nextConfigOutput:"standalone",userland:o}),{requestAsyncStorage:j,staticGenerationAsyncStorage:$,serverHooks:Z}=w,q="/[port]/api/(providers)/(codegpt)/codegptplusbeta/route";function P(){return(0,n.patchFetch)({serverHooks:Z,staticGenerationAsyncStorage:$})}},92810:(e,t,a)=>{a.d(t,{LK:()=>N});var o=a(24330);a(60166);var s=a(20021),r=a(94750),n=a(80050),c=a(8811),d=a(17718),i=a(40618);let p=async e=>{n.Z.post(`${(0,s.vx)()}/copy`,{code:e})},l=async()=>n.Z.get(`${(0,s.vx)()}/paste`).then(e=>e.data),u=async e=>{n.Z.post(`${(0,s.vx)()}/openUrl`,{url:e})},f=async e=>n.Z.post(`${(0,s.vx)()}/openWebviewUrl`,{url:e}).then(e=>e.data),g=async e=>n.Z.post(`${(0,s.vx)()}/insertCode`,{code:e}).then(e=>e.data),h=async(e,t)=>n.Z.post(`${(0,s.vx)()}/config`,{key:e,value:t}).then(e=>e.data),b=async e=>n.Z.post(`${(0,s.vx)()}/orgId`,{value:e}).then(e=>e.data),m=async e=>n.Z.post(`${(0,s.vx)()}/apiKey`,{value:e}).then(e=>e.data),x=async e=>n.Z.post(`${(0,s.vx)()}/customLink`,{value:e}).then(e=>e.data),y=async e=>n.Z.post(`${(0,s.vx)()}/googleOauth`,{value:e}).then(e=>e.data),v=async e=>n.Z.post(`${(0,s.vx)()}/setMaxTokens`,{value:Number(e)}).then(e=>e.data),w=async e=>n.Z.post(`${(0,s.vx)()}/setTemperature`,{value:Number(e)}).then(e=>e.data),j=async e=>n.Z.post(`${(0,s.vx)()}/setWindowMemory`,{value:Number(e)}).then(e=>e.data),$=async e=>n.Z.post(`${(0,s.vx)()}/setRegion`,{value:e}).then(e=>e.data),Z=async e=>n.Z.post(`${(0,s.vx)()}/setAccessKeyId`,{value:e}).then(e=>e.data),q=async e=>n.Z.post(`${(0,s.vx)()}/setSecretAccessKey`,{value:e}).then(e=>e.data),P=async e=>n.Z.post(`${(0,s.vx)()}/setSessionToken`,{value:e}).then(e=>e.data),C=async e=>n.Z.post(`${(0,s.vx)()}/changeIframeUrl`,{url:e}).then(e=>e.data),k=async e=>n.Z.post(`${(0,s.vx)()}/autocompleteEnabled`,{value:e}).then(e=>e.data),T=async e=>n.Z.post(`${(0,s.vx)()}/autocompleteMaxTokens`,{value:Number(e)}).then(e=>e.data),S=async e=>n.Z.post(`${(0,s.vx)()}/autocompleteModel`,{value:e}).then(e=>e.data),O=async e=>n.Z.post(`${(0,s.vx)()}/autocompleteDelay`,{value:Number(e)}).then(e=>e.data),A=async()=>({selectedCode:await n.Z.get(`${(0,s.vx)()}/getSelectedText/full`).then(e=>e.data)}),I=async()=>await r.Z.getFileName(),R=async()=>new Promise((e,t)=>{(0,d.exec)("ollama ls",t=>{e(!t)})}),K=async()=>await n.Z.get(`${(0,s.vx)()}/getProjectStructure`).then(e=>e.data),N=async e=>(console.log(`${(0,s.vx)()}/getFileContent?filePath=${e}`),await n.Z.get(`${(0,s.vx)()}/getFileContent?filePath=${e}`).then(e=>e.data)),X=async()=>{try{let e=await n.Z.get(`http://localhost:54112/${(0,s.vx)().split("http://localhost:")[1]}/api/settings/paths-from-project`);if(!1===e.data.ok)return console.error("No project is currently open.",e.data.error),null;if(!e.data)return console.error("Response data is undefined or null."),null;return e.data}catch(e){throw console.error("Error in getAllPathsFromProject:",e),e}},G=async e=>{let t=await X()||[];return t.length?new c.Z(t).search(e,{limit:6}):[]},L=async()=>{let e=await X()||[];if(!e.length)return[];let t=new Set;for(let a of e){let e=a?.split("/"),o=e?.length>1?e?.pop():a,s=o?.split("."),r=s?.length>1&&s?.pop();r&&t.add(r)}return Array.from(t)},U=async()=>await n.Z.get(`${(0,s.vx)()}/extensionVersion`).then(e=>!1===e.data.ok?(console.error("Error in getExtensionVersion:",e.data.error),null):e.data);(0,i.h)([p,l,u,f,g,h,b,m,x,y,v,w,j,$,Z,q,C,k,T,S,O,A,I,R,K,N,G,X,L,U,P]),(0,o.j)("43d9f8a113de9532d7f1b5158d76df8e6035ae62",p),(0,o.j)("494595f21851e24e2675ab82701473fa766407f6",l),(0,o.j)("065c306c307ba23aaa4f6db681692c28fff69acf",u),(0,o.j)("be0b1e94bccc9bf2f97cfb03dfe2ad2d45b1e08e",f),(0,o.j)("b8b2a06cfc6e2f2bff70a2218f5e6edf51572342",g),(0,o.j)("639ac588af3993db313cc50b124f78d7bdeae5c6",h),(0,o.j)("4f66078350237ca2fbccb2468f686b73ba7d48e5",b),(0,o.j)("c1cbe8fb18030fe2fb0552612558dd591d7e3a6a",m),(0,o.j)("23110510af7e4521b751ca814f230351d92fbfc8",x),(0,o.j)("985414b4c43eb752fd95156f1e0e25b48329a11b",y),(0,o.j)("b57504e3c6736fe21ad47feee5118810127fc521",v),(0,o.j)("01a77ea1f2d7ac26aa9c3809fa6058c5554510b0",w),(0,o.j)("ebd5f93df29041c36fc7878ac6bd2287b8e80b55",j),(0,o.j)("8cec80b1460388afc7c62c6c4a80d044e56b789b",$),(0,o.j)("a6f38e794db85a0cfe61a9946ba0bfad1f977da1",Z),(0,o.j)("3aa157e078d770c04724433f8fcffb048e5840ea",q),(0,o.j)("46307867519e39b0d1f2824f6979ac7dcd69d28a",C),(0,o.j)("79171721318480b6ddfef331134843c78c0e03ef",k),(0,o.j)("eb3c8476530358bec1b2bd936ba6142f81689a23",T),(0,o.j)("e071b912015fb6bac20bb8bd85aa14c8b77d5a57",S),(0,o.j)("816d0b833d5a41aa27415e5466c48710a0cd6eab",O),(0,o.j)("bdf0c56a5e7ff99fb7034af78b7573252d609a78",A),(0,o.j)("9ef61f493ad7e742ef4b625e835df92eb1757794",I),(0,o.j)("e93dc668f76aa03b424a7331e85ea18f21bdda31",R),(0,o.j)("8a47bc18e9d03b84169eb3752379a5f28a84327e",K),(0,o.j)("d10992d2f26bdaf3e1200801a9a2288f2bef2855",N),(0,o.j)("2b2edcffca34048d07293a8d9cc28477aa9164d6",G),(0,o.j)("4219fbe6f6fbb131c58a527305f7d1edcee275a8",X),(0,o.j)("c9e6df4eb710b551fc8e6b489a51061df934531d",L),(0,o.j)("0ca3b749e1b88374a50d08881f6f99cee2242df1",U),(0,o.j)("c3c88ce47acb86a5a282c00537f75035759d5b86",P)}};var t=require("../../../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),o=t.X(0,[8948,1203,50,4104,6292,7179,8811,6342,8910],()=>a(31944));module.exports=o})();