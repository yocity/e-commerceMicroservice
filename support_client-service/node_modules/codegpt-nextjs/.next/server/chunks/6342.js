"use strict";exports.id=6342,exports.ids=[6342],exports.modules={87385:(e,t,a)=>{a.d(t,{j:()=>d});var s=a(24330);a(60166);var o=a(20021),n=a(50249),i=a(80050),r=a(71615),c=a(40618);let d=async({accessToken:e,refreshToken:t,expiresAt:a})=>{console.log("SET VICUNA SESSION"),e||t||a||(0,n.R)((0,r.cookies)()).auth.signOut();let s=null;for(let n=54113;n<=54130;n++){console.log(`Trying port ${n}`);try{s=await i.Z.post(`http://localhost:${n}/vicunaSession`,{accessToken:e,refreshToken:t,expiresAt:a}).then(e=>e.data);let r=e||o.Xd.apiKey,c=await fetch("https://api.codegpt.co/api/v1/me",{method:"GET",cache:"no-store",...r?{headers:{Authorization:`Bearer ${r}`}}:{}}),d=await c.json(),l=d?.user?.distinct_id;l&&"undefined"!==l&&await i.Z.post(`${(0,o.vx)()}/userId`,{value:l});break}catch(e){console.log(`Port ${n} is closed or not responding.`)}}return s};(0,c.h)([d]),(0,s.j)("cb8707d39cee2d6b73f7d2a0c3a37eb9243fb61d",d)},74506:(e,t,a)=>{a.d(t,{Z:()=>r});var s=a(87385),o=a(20021),n=a(50249),i=a(71615);async function r(){let e=o.Xd?.secrets?.vicunaSession,t=e?JSON.parse(e):void 0,a=t?.accessToken;if(a&&parseInt(t.expiresAt+"000")<Date.now()){let e=(0,n.R)((0,i.cookies)()),{data:o,error:r}=await e.auth.refreshSession({refresh_token:t.refreshToken});r?(console.log("vicu\xf1a refreshSession error: ",r.message),(r.message.includes("Refresh Token Not Found")||r.message.includes("Already Used"))&&await (0,s.j)({accessToken:"",refreshToken:"",expiresAt:""})):(await (0,s.j)({accessToken:o.session.access_token,refreshToken:o.session.refresh_token,expiresAt:String(o.session.expires_at)}),a=o.session.access_token)}return a}},20021:(e,t,a)=>{a.d(t,{Xd:()=>o,ed:()=>n,vx:()=>s});let s=()=>{let{headers:e}=a(71615),t=e().get("referer").split("/")[3];return t.includes("?")&&(t=t.split("?")[0]),console.log({extensionUrl:`http://localhost:${t}`}),`http://localhost:${t}`},o={},n=e=>{o=e}},50249:(e,t,a)=>{a.d(t,{R:()=>i});var s=a(93306);let o="https://auth.codegpt.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJyb3h1dnNyc2RieGFjb2twcmF1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2OTU0OTEyNzgsImV4cCI6MjAxMTA2NzI3OH0.fyyxVq2c2eLIExMQEUxP8wNoyY2UumBrfN5So16TCno";(0,s.AY)(o,n);let i=e=>(0,s.lx)(o,n,{cookies:{get:t=>e.get(t)?.value,set(t,a,s){try{e.set({name:t,value:a,...s})}catch(e){}},remove(t,a){try{e.set({name:t,value:"",...a})}catch(e){}}}})},56342:(e,t,a)=>{a.d(t,{q:()=>c});var s=a(24330);a(60166);var o=a(74506),n=a(94750),i=a(80050),r=a(40618);let c=async({eventName:e,provider:t,model:a,promptTokens:s,completionTokens:o,totalTokens:i,target:r,value:c,statusCode:l,object:g,message:p,code_language:u,functionName:h})=>{let[y,w,v,x,m]=await Promise.all([n.Z.getIsAnonymous(),n.Z.getIdeLanguage(),n.Z.getUserId(),n.Z.getVersion(),a?n.Z.getLanguage():""]);d({event:e||"Chat",data:{...{userType:"false"===y?"anonymous":"registered",...t?{provider:t}:{},...a?{model:a}:{},...s?{prompt_tokens:s}:{},...o?{completion_tokens:o}:{},...i?{total_tokens:i}:{},...r?{target:r}:{},...c?{value:c}:{},...g?{object:g}:{},...p?{message:p}:{},...m?{language_code:m}:{},...u?{code_language:u}:{},...h?{function_name:h}:{},language:w,source:process.env.SOURCE||"vscode",codeGPTVersion:x},...l?{statusCode:l}:{}},userId:v})};async function d({event:e,data:t,userId:a}){let s=[{event:e,properties:{...t,time:Date.now(),distinct_id:a,$insert_id:crypto.randomUUID()}}],n=await (0,o.Z)();await i.Z.post("https://api.codegpt.co/api/v1/telemetry",s,{headers:{"Content-Type":"application/json",...n?{Authorization:`Bearer ${n}`}:{}}}).catch(e=>{console.error("Error sending telemetry",e)})}(0,r.h)([c]),(0,s.j)("395448ad66a04a8ccb5507391feafc0ccded9c25",c)},94750:(e,t,a)=>{a.d(t,{Z:()=>n});var s=a(20021),o=a(80050);let n={context:{secrets:{delete:async e=>await o.Z.delete(`${(0,s.vx)()}/secret/${e}`),store:async(e,t)=>await o.Z.post(`${(0,s.vx)()}/secrets`,{key:e,value:t})},globalState:{update:async(e,t)=>await o.Z.post(`${(0,s.vx)()}/globalState`,{key:e,value:t})}},window:{showErrorMessage:async e=>await o.Z.post(`${(0,s.vx)()}/showErrorMessage`,{message:e}),showWarningMessage:async e=>await o.Z.post(`${(0,s.vx)()}/showWarningMessage`,{message:e}),showInformationMessage:async e=>await o.Z.post(`${(0,s.vx)()}/showInformationMessage`,{message:e})},commands:{executeCommand:async e=>await o.Z.post(`${(0,s.vx)()}/executeCommand`,{command:e})},workspace:{getConfiguration:()=>({update:async(e,t)=>await o.Z.post(`${(0,s.vx)()}/config`,{key:e,value:t})})},newFileWithCode:async e=>await o.Z.post(`${(0,s.vx)()}/newFileWithCode`,{code:e}),insertCode:async e=>await o.Z.post(`${(0,s.vx)()}/insertCode`,{code:e}),getSelectedText:async()=>(await o.Z.get(`${(0,s.vx)()}/getSelectedText`)).data,getLanguage:async()=>{let e=await o.Z.get(`${(0,s.vx)()}/language`);return e.data.includes("react")?"jsx":e.data},getFileName:async()=>(await o.Z.get(`${(0,s.vx)()}/filename`)).data,getIdeLanguage:async()=>(await o.Z.get(`${(0,s.vx)()}/ideLanguage`)).data,getUserId:async()=>(await o.Z.get(`${(0,s.vx)()}/userId`)).data,getVersion:async()=>(await o.Z.get(`${(0,s.vx)()}/version`)).data,getIsAnonymous:async()=>(await o.Z.get(`${(0,s.vx)()}/isAnonymous`)).data}}};